# Лабораторная работа №4
## Тема: Методы снижения размерности и регуляризация логистической регрессии

### Цель работы
Построение моделей классификации для прогнозирования дефолта клиентов (переменная `Y`) на основе набора данных по кредитным картам. Сравнение методов снижения размерности (PCA) и L2-регуляризации (Ridge).

### Данные и Предобработка

* **Набор данных:** `default_of_credit_card_clients.csv`.
* **Отбор признаков:** Из анализа исключены переменные: `PAY_3`–`PAY_6` и `BILL_AMT3`–`BILL_AMT6`.
* **Разделение выборки:**
    * **Обучающая (Train):** 85% данных.
    * **Отложенная (Test):** 15% данных (используется только для финального прогноза).
* **Нормализация:** Применена стандартизация (`StandardScaler`).

### Ход выполнения

#### 1. Предварительный анализ (EDA)
* Проведена проверка на пропуски (отсутствуют).
* Построена **корреляционная матрица** и отфильтрованы статистически значимые корреляции (p-value < 0.05).
* Визуализированы распределения признаков относительно целевой переменной с помощью **Boxplots**.

#### 2. Снижение размерности (PCA)
* Применен метод главных компонент (**PCA**).
* Рассчитаны доли объясненной дисперсии для выбора количества компонент.
* Построена модель **Logistic Regression** на преобразованных данных.

#### 3. Регуляризация (Ridge)
* Использована **LogisticRegressionCV** с **L2-регуляризацией (Ridge)**.
* Оптимальный гиперпараметр $C$ подобран автоматически через кросс-валидацию (найденное значение $C \approx 2.78$).
* Построен график **следов коэффициентов**, показывающий изменение весов признаков при изменении силы регуляризации.

### Результаты и Метрики

Сравнение точности моделей на кросс-валидации (10 блоков):

| Модель | Метод | CV Accuracy (Точность) |
| :--- | :--- | :--- |
| **logit_PC2** | Логистическая регрессия на PCA компонентах | **0.792** |
| **logit_ridge** | Логистическая регрессия с L2-регуляризацией | **0.809** |

** Лучшая модель:** `logit_ridge` (L2-регуляризация).

#### Финальный прогноз на отложенной выборке (15%)

Итоговые метрики классификации для лучшей модели (Ridge):

| Метрика | Значение |
| :--- | :--- |
| **Accuracy (Общая точность)** | **0.81** |
| **Macro Avg F1-score** | **0.63** |
| **Weighted Avg F1-score** | **0.85** |

**Детальный отчет по классам:**
* **Класс 0 (Не дефолт):** Высокая точность (Precision: 0.97) и полнота (Recall: 0.82).

* **Класс 1 (Дефолт):** Низкая точность (Precision: 0.24), но приемлемая полнота (Recall: 0.73).
